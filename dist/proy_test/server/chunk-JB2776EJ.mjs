import './polyfills.server.mjs';
import{b as F,d as T,e as _,f as E,g as M,i as G,j as L,k as N,o as j,p as q,r as A}from"./chunk-T7QUTHYJ.mjs";import{D as g,E as w,Ea as S,F as c,Mb as I,Pb as R,Qb as V,Z as i,_ as f,ea as m,ga as s,k as x,ka as o,kb as P,la as n,ma as d,pa as b,qa as v,qb as k,ra as p,wa as l,x as C,xa as h,ya as y}from"./chunk-W6XYX7DX.mjs";import"./chunk-5XUXGTUW.mjs";function z(t,r){if(t&1&&(o(0,"div",9)(1,"p"),l(2),n()()),t&2){let e=p();i(2),h(e.successMessage)}}function D(t,r){if(t&1&&(o(0,"div",10)(1,"p"),l(2),n()()),t&2){let e=p();i(2),h(e.errorMessage)}}function O(t,r){t&1&&(o(0,"div",11),c(),o(1,"svg",12),d(2,"circle",13)(3,"path",14),n()())}function H(t,r){t&1&&(c(),o(0,"svg",27),d(1,"path",28)(2,"path",29),n())}function J(t,r){t&1&&(c(),o(0,"svg",27),d(1,"path",30),n())}function K(t,r){t&1&&(o(0,"div"),l(1," La contrase\xF1a es obligatoria. "),n())}function Q(t,r){t&1&&(o(0,"div"),l(1," La contrase\xF1a debe tener al menos 8 caracteres. "),n())}function U(t,r){if(t&1&&(o(0,"div",31),m(1,K,2,0,"div",32)(2,Q,2,0,"div",32),n()),t&2){let e=p(2);i(),s("ngIf",e.passwordControl==null||e.passwordControl.errors==null?null:e.passwordControl.errors.required),i(),s("ngIf",e.passwordControl==null||e.passwordControl.errors==null?null:e.passwordControl.errors.minlength)}}function W(t,r){t&1&&(c(),o(0,"svg",27),d(1,"path",28)(2,"path",29),n())}function X(t,r){t&1&&(c(),o(0,"svg",27),d(1,"path",30),n())}function Y(t,r){t&1&&(o(0,"div"),l(1," Debes confirmar tu contrase\xF1a. "),n())}function Z(t,r){if(t&1&&(o(0,"div",31),m(1,Y,2,0,"div",32),n()),t&2){let e=p(2);i(),s("ngIf",e.passwordConfirmControl==null||e.passwordConfirmControl.errors==null?null:e.passwordConfirmControl.errors.required)}}function $(t,r){t&1&&(o(0,"div",31),l(1," Las contrase\xF1as no coinciden. "),n())}function ee(t,r){t&1&&(o(0,"span",33),c(),o(1,"svg",34),d(2,"circle",13)(3,"path",14),n()())}function te(t,r){t&1&&(o(0,"span",33),c(),o(1,"svg",35),d(2,"path",36),n()())}function re(t,r){if(t&1){let e=b();o(0,"form",15),v("ngSubmit",function(){g(e);let u=p();return w(u.onSubmit())}),o(1,"div",16)(2,"div",17)(3,"label",18),l(4,"Nueva contrase\xF1a"),n(),d(5,"input",19),o(6,"button",20),v("click",function(){g(e);let u=p();return w(u.togglePasswordVisibility())}),m(7,H,3,0,"svg",21)(8,J,2,0,"svg",21),n(),m(9,U,3,2,"div",22),n(),o(10,"div",17)(11,"label",23),l(12,"Confirmar contrase\xF1a"),n(),d(13,"input",24),o(14,"button",20),v("click",function(){g(e);let u=p();return w(u.toggleConfirmPasswordVisibility())}),m(15,W,3,0,"svg",21)(16,X,2,0,"svg",21),n(),m(17,Z,2,1,"div",22)(18,$,2,0,"div",22),n()(),o(19,"div")(20,"button",25),m(21,ee,4,0,"span",26)(22,te,3,0,"span",26),l(23),n()()()}if(t&2){let e=p();s("formGroup",e.resetForm),i(5),s("type",e.showPassword?"text":"password"),i(2),s("ngIf",!e.showPassword),i(),s("ngIf",e.showPassword),i(),s("ngIf",(e.passwordControl==null?null:e.passwordControl.invalid)&&((e.passwordControl==null?null:e.passwordControl.dirty)||(e.passwordControl==null?null:e.passwordControl.touched))),i(4),s("type",e.showConfirmPassword?"text":"password"),i(2),s("ngIf",!e.showConfirmPassword),i(),s("ngIf",e.showConfirmPassword),i(),s("ngIf",(e.passwordConfirmControl==null?null:e.passwordConfirmControl.invalid)&&((e.passwordConfirmControl==null?null:e.passwordConfirmControl.dirty)||(e.passwordConfirmControl==null?null:e.passwordConfirmControl.touched))),i(),s("ngIf",e.resetForm.hasError("notSame")&&(e.passwordConfirmControl==null?null:e.passwordConfirmControl.dirty)&&!(!(e.passwordConfirmControl==null||e.passwordConfirmControl.errors==null)&&e.passwordConfirmControl.errors.required)),i(2),s("disabled",e.isLoading||e.resetForm.invalid),i(),s("ngIf",e.isLoading),i(),s("ngIf",!e.isLoading),i(),y(" ",e.isLoading?"Procesando...":"Restablecer contrase\xF1a"," ")}}function oe(t,r){t&1&&(o(0,"div",37)(1,"a",38),l(2," Solicitar un nuevo enlace de recuperaci\xF3n "),n()())}var B=class t{constructor(r,e,a,u){this.fb=r;this.authService=e;this.route=a;this.router=u;this.resetForm=this.fb.group({password:["",[_.required,_.minLength(8)]],password_confirmation:["",_.required]},{validators:this.checkPasswords})}resetForm;isLoading=!1;errorMessage=null;successMessage=null;showPassword=!1;showConfirmPassword=!1;token=null;email=null;isTokenValid=!1;isTokenValidating=!0;ngOnInit(){if(this.token=this.route.snapshot.queryParamMap.get("token"),this.email=this.route.snapshot.queryParamMap.get("email"),!this.token||!this.email){this.errorMessage="Enlace de recuperaci\xF3n inv\xE1lido. Por favor solicita un nuevo enlace.",this.isTokenValidating=!1;return}this.authService.validateResetToken(this.token,this.email).pipe(x(()=>this.isTokenValidating=!1)).subscribe({next:()=>{this.isTokenValid=!0},error:r=>{this.errorMessage=r.error.message||"El enlace de recuperaci\xF3n no es v\xE1lido o ha expirado."}})}checkPasswords(r){let e=r.get("password")?.value,a=r.get("password_confirmation")?.value;return e===a?null:{notSame:!0}}get passwordControl(){return this.resetForm.get("password")}get passwordConfirmControl(){return this.resetForm.get("password_confirmation")}togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}onSubmit(){this.resetForm.invalid||(this.isLoading=!0,this.errorMessage=null,this.successMessage=null,this.authService.resetPassword({email:this.email,token:this.token,password:this.resetForm.value.password,password_confirmation:this.resetForm.value.password_confirmation}).pipe(x(()=>this.isLoading=!1)).subscribe({next:r=>{this.successMessage=r.message||"Tu contrase\xF1a ha sido restablecida exitosamente.",this.resetForm.reset(),setTimeout(()=>{this.router.navigate(["/auth/login"])},3e3)},error:r=>{this.errorMessage=r.error.message||"Ocurri\xF3 un error al restablecer tu contrase\xF1a. Intenta de nuevo."}}))}static \u0275fac=function(e){return new(e||t)(f(q),f(F),f(I),f(R))};static \u0275cmp=C({type:t,selectors:[["app-reset-password"]],standalone:!0,features:[S],decls:12,vars:5,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-indigo-50","to-blue-100","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8","bg-white","p-8","rounded-xl","shadow-lg","border","border-gray-200"],[1,"mt-2","text-center","text-3xl","font-extrabold","text-gray-900"],[1,"mt-2","text-center","text-sm","text-gray-600"],["class","bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4 rounded-md","role","alert",4,"ngIf"],["class","bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4 rounded-md","role","alert",4,"ngIf"],["class","flex justify-center py-10",4,"ngIf"],["class","mt-8 space-y-6",3,"formGroup","ngSubmit",4,"ngIf"],["class","text-center",4,"ngIf"],["role","alert",1,"bg-green-100","border-l-4","border-green-500","text-green-700","p-4","mb-4","rounded-md"],["role","alert",1,"bg-red-100","border-l-4","border-red-500","text-red-700","p-4","mb-4","rounded-md"],[1,"flex","justify-center","py-10"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-10","w-10","text-indigo-600"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"mt-8","space-y-6",3,"ngSubmit","formGroup"],[1,"space-y-5"],[1,"relative"],["for","password",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","password","name","password","formControlName","password","autocomplete","new-password","required","","placeholder","Nueva contrase\xF1a",1,"appearance-none","block","w-full","px-3","py-2.5","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"type"],["type","button",1,"absolute","right-0","top-8","pr-3","flex","items-center","text-sm","leading-5",3,"click"],["xmlns","http://www.w3.org/2000/svg","class","h-5 w-5 text-gray-500","fill","none","viewBox","0 0 24 24","stroke","currentColor",4,"ngIf"],["class","text-xs text-red-500 mt-2 ml-1",4,"ngIf"],["for","password_confirmation",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","password_confirmation","name","password_confirmation","formControlName","password_confirmation","autocomplete","new-password","required","","placeholder","Confirmar contrase\xF1a",1,"appearance-none","block","w-full","px-3","py-2.5","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"type"],["type","submit",1,"group","relative","w-full","flex","justify-center","py-2.5","px-4","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-indigo-600","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","disabled:opacity-50","disabled:cursor-not-allowed","shadow-sm","transition-colors","duration-200",3,"disabled"],["class","absolute left-0 inset-y-0 flex items-center pl-3",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"],[1,"text-xs","text-red-500","mt-2","ml-1"],[4,"ngIf"],[1,"absolute","left-0","inset-y-0","flex","items-center","pl-3"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-white"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","aria-hidden","true",1,"h-5","w-5","text-indigo-500","group-hover:text-indigo-400"],["fill-rule","evenodd","d","M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule","evenodd"],[1,"text-center"],["routerLink","/auth/forgot-password",1,"font-medium","text-indigo-600","hover:text-indigo-500"]],template:function(e,a){e&1&&(o(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),l(4," Restablecer contrase\xF1a "),n(),o(5,"p",3),l(6," Crea una nueva contrase\xF1a segura para tu cuenta "),n()(),m(7,z,3,1,"div",4)(8,D,3,1,"div",5)(9,O,4,0,"div",6)(10,re,24,14,"form",7)(11,oe,3,0,"div",8),n()()),e&2&&(i(7),s("ngIf",a.successMessage),i(),s("ngIf",a.errorMessage),i(),s("ngIf",a.isTokenValidating),i(),s("ngIf",a.isTokenValid&&!a.isTokenValidating),i(),s("ngIf",!a.isTokenValidating&&!a.isTokenValid&&a.errorMessage))},dependencies:[k,P,A,G,T,E,M,j,L,N,V],encapsulation:2})};export{B as ResetPasswordComponent};
